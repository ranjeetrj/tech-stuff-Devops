server {
    listen 80;
    server_name pivotchain.in;
    client_max_body_size 100M;
    return 301 https://pivotchain.in$request_uri;
}

    upstream eventapp {
       server 10.13.10.12;
       server 10.13.10.13;
    }

    upstream mobileapp {
       server 10.13.10.12;
       server 10.13.10.13;
    }


    upstream analytics {
       server 10.13.10.12;
       server 10.13.10.13;
    }

    upstream ingress {
       server 10.13.10.12;
       server 10.13.10.13;
    }



    upstream nginx {
       server 10.13.10.12;
       server 10.13.10.13;
    }

server {
    listen              443 ssl;
    server_name         pivotchain.in;
    ssl_certificate     /etc/nginx/ssl/server.crt;
    ssl_certificate_key /etc/nginx/ssl/server.key;
    client_max_body_size 1024M;

 location / {
                    add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload';
                    add_header X-Content-Type-Options nosniff;
                    proxy_set_header    Host            $host;
                    proxy_set_header    X-Real-IP       $remote_addr;
                    proxy_set_header    X-Forwarded-for $remote_addr;
                    proxy_connect_timeout 300;
                    proxy_read_timeout 300;
                    proxy_send_timeout 300;
                    port_in_redirect off;
                    proxy_pass http://ingress/;
                    client_max_body_size 1024M;
                    proxy_ignore_client_abort on;
                    
                }

location /event-app/ {
                    add_header X-Content-Type-Options nosniff;
                    add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload';
                    proxy_set_header    Host            $host;
                    proxy_set_header    X-Real-IP       $remote_addr;
                    proxy_set_header    X-Forwarded-for $remote_addr;
                    proxy_connect_timeout 300;
                    proxy_read_timeout 300;
                    proxy_send_timeout 300;
                    port_in_redirect off;
                    proxy_pass http://eventapp;
                    client_max_body_size 100M;

                }


location /mobile-app/ {
                    add_header X-Content-Type-Options nosniff;
                    add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload';
                    proxy_set_header    Host            $host;
                    proxy_set_header    X-Real-IP       $remote_addr;
                    proxy_set_header    X-Forwarded-for $remote_addr;
                    proxy_connect_timeout 300;
                    proxy_read_timeout 300;
                    proxy_send_timeout 300;
                    port_in_redirect off;
                    proxy_pass http://mobileapp;
                    client_max_body_size 100M;
                    error_log  /var/log/nginx/mobileapp_error.log;
                    access_log  /var/log/nginx/mobileapp_access.log;
                }


location /analytics-app/ {
                    add_header X-Content-Type-Options nosniff;
                    add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload';
                    proxy_set_header    Host            $host;
                    proxy_set_header    X-Real-IP       $remote_addr;
                    proxy_set_header    X-Forwarded-for $remote_addr;
                    proxy_connect_timeout 300;
                    proxy_read_timeout 300;
                    proxy_send_timeout 300;
                    port_in_redirect off;
                    proxy_pass http://analytics;
                    client_max_body_size 1024M;
                    proxy_ignore_client_abort on;

                }


location /nginx/ {
                    add_header X-Content-Type-Options nosniff;
                    add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains; preload';
                    proxy_set_header    Host            $host;
                    proxy_set_header    X-Real-IP       $remote_addr;
                    proxy_set_header    X-Forwarded-for $remote_addr;
                    proxy_connect_timeout 300;
                    proxy_read_timeout 300;
                    proxy_send_timeout 300;
                    port_in_redirect off;
                    proxy_pass http://nginx;
                    client_max_body_size 100M;

                }

location /ISO/ {
                alias /usr/local/ISO_UPDATE/;
                autoindex on;
                auth_basic "Restricted Content";
                auth_basic_user_file /etc/nginx/auth/htpasswd;
        }

location /release/ {
                alias /usr/local/RELEASE/;
                autoindex on;
                auth_basic "Restricted Content";
                auth_basic_user_file /etc/nginx/auth/htpasswd;
        }

location /doc-images/ {
                alias /usr/local/dock-images/;
                autoindex on;
        }


}
